' Gambas class file

'
' Traducción de programas.
' Interfaz de translate-shell para traducir programas completos de gambas y otras utilidades.
'
' Copyright (C) Martín Belmonte
'
' This program is free software; you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation; either version 2 of the License, or
' (at your option) any later version.
'
' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.
'
' You should have received a copy of the GNU General Public License
' along with this program; if not, write to the Free Software
' Foundation, Inc., 51 Franklin St, Fifth Floor,
' Boston, MA  02110-1301  USA
'

Public Sub Form_Open()

  Dim intF As Integer
  Dim stxLang As New String[]
  Dim intLang As Integer
  Dim chk As CheckBox
  Dim strText As String
  Dim intType As Integer
  Dim stxType As New String[]
  Dim inxTypeKey As New Integer[]
  Dim intTab As Integer
  Dim intCounter As Integer
  Dim intKeySel As Integer

  stxType.Clear
  inxTypeKey.Clear
  stxLang.Clear

  For intF = 0 To MInit.stxLocLang.Max
    cmoLanguage.Add(MInit.stxLocLang[intF])
  Next

  cmoLanguage.Text = Settings["Language", "es"]
  lblLanguage.Text = ("Idioma de entrada") & ":  "
  lblLangOut.Text = ("Idiomas de salida")

  intCounter = 0

  For intType = 0 To FMain.stxSysLangFamy.Max
    If stxType.Find(FMain.stxSysLangFamy[intType]) = -1 Then
      stxType.Add(FMain.stxSysLangFamy[intType])
      inxTypeKey.Add(intCounter)
      Inc intCounter
    Endif
  Next

  If stxType.Count > 0 Then

    TabPanel1.Count = stxType.Count

    For intTab = 0 To stxType.Max
      TabPanel1[intTab].Text = stxType[intTab]

    Next
  Endif

  For intLang = 0 To FMain.stxSysLangName.Max

    intKeySel = stxType.Find(FMain.stxSysLangFamy[intLang])

    chk = New CheckBox(TabPanel1[intKeySel]) As "GrpCheck"

    With chk
      .Name = "chk" & CStr(intLang)
      strText = FMain.stxSysLangDesc[FMain.stxSysLangName.Find(FMain.stxSysLangName[intLang])]
      .Text = strText
      .Tag = FMain.stxSysLangName[intLang]
      .Width = 7 * String.Len(strText)
      .Height = 28
      .Value = Settings["Output/" & String.UCase(FMain.stxSysLangName[intLang]), 0]
    End With

  Next

End

Public Sub tobSave_Click()

  Dim intTab As Integer
  Dim obj As Object

  For intTab = 0 To TabPanel1.Count - 1
    For Each obj In TabPanel1[intTab].Children
      If Object.Type(obj) = "CheckBox" Then
        Settings["Output/" & String.UCase(obj.Tag)] = obj.Value
      Endif
    Next
  Next

  Settings["Language"] = cmoLanguage.Text
  FMain.CheckLang()
  Me.Close

End

Public Sub tobExit_Click()

  Me.Close

End

Public Sub tobClear_Click()

  Dim intTab As Integer
  Dim obj As Object

  For intTab = 0 To TabPanel1.Count - 1
    For Each obj In TabPanel1[intTab].Children
      If Object.Type(obj) = "CheckBox" Then
        obj.Value = 0
      Endif
    Next
  Next

End

' Public Sub GrpCheck_Click()
'
'   Dim chk As CheckBox
'
'   chk = Last
'
'  Print chk.Name & " Tag:" & chk.Tag
'
' End
